Атрибуты:

StudentId, StudentName, GroupId, GroupName, CourseId, CourseName, LecturerId, LecturerName, Mark

Сократим для удобства

SI, SN, GI, GN, CI, CN, LI, LN, M

Функциональные зависимости:

1. SI -> SN
2. SI -> GI
3. GI -> GN 
4. CI -> CN
5. LI -> LN
6. SI, CI -> M
7. GI, CI -> LI
8. GN -> GI

Ключ: (SI, CI)

Первая нормальная форма:

Отношение находится в первой нормальной форме.

Ключ: (SI, CI)
Все атрибуты атомарны.
В отношении нет повторяющихся групп.

Вторая нормальная форма:

1. SI -> SN
2. SI -> GI
3. GI -> GN 
4. CI -> CN
5. LI -> LN
6. SI, CI -> M
7. GI, CI -> LI
8. GN -> GI

CI -> CN
	Не удовлетворяет второй нормальной форме, так как зависит от части составного ключа.
	
	Построим декомпозицию:
	- (CI, CN) 4. 

		Ключом является (CI) и он единственный. 
		Неключевые атрибуты функционально зависят от ключа в целом (очевидно, ключ не составной).
		Отношение в 2НФ.

		Для всех ФЗ отношения левая часть является надключом => находится в нормальной форме Бойса-Кодда.
		Наше отношение в НФБК (хотя, достаточно 3НФ) и все ключи простые, следовательно, по первой теореме Дейта-Фейгина наше отношение в 5НФ.

	- (SI, SN, GI, GN, CI, LI, LN, M) 1, 2, 3, 5, 6, 7, 8
		Ключ (SI, CI). Построим декомпозицию по ФЗ: CI GI -> LI, LN, GN -- выводится очевидным образом из ФЗ (3, 5, 7).

		-- (CI, GI, LN, LI, GN) 3, 5, 7, 8
				Два ключа (CI, GI) и (CI, GN). Не в 2НФ, так как есть ФЗ №3 (GI -> GN)

				--- (GI, GN) 3, 7, 8
							Два ключа GI и GN. Все ключи простые, 5НФ.

				--- (GI, CI, LI, LN) 5, 7
							Ключ (CI, GI). Находится в 2НФ. Не находится в 3НФ так как LN транзитивно зависит от ключа.

							---- (LI, LN) 3.
										Ключ LI. 5НФ аналогично
							---- (GI, CI, LI) 5.
										Ключ (GI, CI). Находится в НФБК.

		-- (CI, GI, SI, SN, M) 1, 2, 6
				Ключ (SI, CI). Не в 2НФ, так как есть ФЗ №2 (SI -> GI). 

				--- (SI, SN, GI) 1, 2. 
							Ключ SI. В 5НФ аналогично.

				--- (SI, CI, M) 6.
							Ключ (SI, CI). Находится в НФБК.

Выпишем все полученные отношения:

(SI, SN, GI) --- ключ SI. 5НФ
(CI, CN) --- ключ CI. 5НФ
(CI, SI, M) -- ключ (SI, CI). НФБК
(GI, GN) --- ключи GI, GN. 5НФ
(LI, LN) -- ключ LI. 5НФ
(CI, GI, LI) -- (GI, CI). НФБК

4НФ
(CI, SI, M)
Ключ (SI, CI)

SI ->> CI | M
Утверждает, что у студента все оценки по всем курсам одинаковые.
Контр пример - любой студент с разными оценками.

CI ->> SI | M
У всех студентов курса одинаковые оценки.
Контр пример - два любых студента с разными оценками.

M ->> SI | CI
Оценка определяет множество студентов вне зависимости от курса.
Контр пример: 
	На курсе X студент A имеет оценку 5.
	На курсе Y студент B имеет оценку 5.
	Студент A не посещает курс Y. Студент B посещает курс X и имеет оценку 2.

	Соответственно множество студентов имеющих оценку 5 на разных курса разное.

empty ->> SI CI | M
Оценки не зависят от студентов и курсов.
Контр пример - две оценки 5 у разных студентов на рызных курсах.

empty ->> M  CI | SI
Студенты не зависят от оценок и курсов.
Контр пример - студент посещающий разные курсы и получающий разные оценки.

empty ->> M  SI | CI
Курсы не зависят от оценок и студентов.
Контр пример: студенты на разных курсах с разными оценками.

SI CI ->> M | empty -- тривиальная
--------- 4НФ ------

Нет смысла рассматривать разбиение на два множества атрибутов тк у нас 4НФ. Так как разбиение на 2 это МЗ.
Если один из элементов ЗС является надмножеством другого, то изначальное ЗС эквивалентно ЗС меньшего размера.
Если в ЗС есть таблица из трех атрибутов, то эта ЗС тривиальная.
Не имеет смысла рассматривать ЗС у которых все множества размера 1, так как результат join будет пустым.

(SI CI; SI M; CI M)
CI  SI M
1   1  A
1   2  B

Проекции
CI  SI   SI  M   CI  M
1    1    1  A   1   A
1		 2    2  B   1   B

При объединении количество записей увелится, все возможные пары 1A, 1B, 2A, 2B

Тогда наше отношение в 5НФ, так как у нас 0 ЗС, для пустого множества ЗС все предикаты верны => определение 4НФ и 5НФ выполняются.

(CI, GI, LI)
Ключ (CI, GI)

CI ->> GI | LI
У курса все преподаватели по всем группам одинаковые.
Контр пример: разные лекторы ведут группы 31-34 и 35-39.

LI ->> GI | CI
У лектора все группы и курсы одинаковые.
Контр пример: лектор ведет у разных групп и разные курсы (Базы данных на весь поток и Введение в программирование тоже на весь поток)

GI ->> CI | LI
У группы все курсы и лекторы одинаковые.
Контр пример: разные курсы ведут разные лекторы для одной группы. (Матан и линал ведут разные люди)

empty ->> CI GI | LI
Лекторы не зависят от групп и курсов.
Контр пример: лектор ведет разные курсы у разных групп.

empty ->> CI LI | GI
Группы не зависят от курсов и лекторов.
Контр пример: У группы проходят разные курсы и ведут их разные лекторы.

empty ->> GI LI | CI
Курс не зависит от групп и лекторов.
Контр пример: курс ведут разные лекторы у разных групп.
--------- 4НФ ------

Доказательство 5НФ полностью аналогично доказательству выше, при замене колонок.


(SI, SN, GI) --- ключ SI. 5НФ
(CI, CN) --- ключ CI. 5НФ
(CI, SI, M) -- ключ (SI, CI). 5НФ
(GI, GN) --- ключи GI, GN. 5НФ
(LI, LN) -- ключ LI. 5НФ
(CI, GI, LI) -- (GI, CI). 5НФ
